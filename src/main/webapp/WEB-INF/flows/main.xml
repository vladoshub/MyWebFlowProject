<?xml version="1.0" encoding="UTF-8"?>
<flow xmlns="http://www.springframework.org/schema/webflow"
      xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
      xsi:schemaLocation="http://www.springframework.org/schema/webflow
    http://www.springframework.org/schema/webflow/spring-webflow-2.4.xsd">

    <var name="out"
         class="ru.mmtr.flow.Out"/>
    <var name="type"
         class="ru.mmtr.flow.TypeVoc"/>

    <view-state id="main" view="main">
        <transition on="nextRus" to="temp">
            <set  name = "type.type"  value = "1"/>
        </transition>
        <transition on="nextBin" to="temp">
            <set  name = "type.type"  value = "2"/>
        </transition>
    </view-state>


    <view-state id="voc" view="voc">
        <transition on="SearchKeys" >
            <evaluate result="out" expression=
                    "ChangeOps.searchFromWebByKey(requestParameters.searchkey,type.type)"/>
        </transition>

        <transition on="SearchWords" >
            <evaluate result="out" expression=
                    "ChangeOps.searchFromWebByWords(requestParameters.searchword,type.type)"/>
        </transition>

        <transition on="addWordss" >
            <evaluate result="out" expression=
                    "ChangeOps.addFromWeb(requestParameters.key,requestParameters.word,type.type)"/>
            <render fragments="voc"/>
        </transition>

        <transition on="addWordsss" >
            <evaluate result="out" expression=
                    "ChangeOps.addFromWebToKey(requestParameters.ID,requestParameters.word,type.type)"/>
            <render fragments="voc"/>
        </transition>

        <transition on="editWord" >
            <evaluate result="out" expression=
                    "ChangeOps.updateByWordFromWeb(requestParameters.ID,requestParameters.word,type.type,requestParameters.kID)"/>
            <render fragments="voc"/>
        </transition>

        <transition on="editKey" >
            <evaluate result="out" expression=
                    "ChangeOps.updateByKeyFromWeb(requestParameters.ID,requestParameters.key,type.type)"/>
            <render fragments="voc"/>
        </transition>

        <transition on="deletedWord" >
            <evaluate result="out" expression=
                    "ChangeOps.delFromWebByWord(requestParameters.ID,type.type,requestParameters.kID)"/>
            <render fragments="voc"/>
        </transition>

        <transition on="deletedKey" >
            <evaluate result="out" expression=
                    "ChangeOps.delFromWebByKey(requestParameters.ID,type.type)"/>
            <render fragments="voc"/>
        </transition>

        <transition on="editManyWordsInKey" >
            <evaluate result="out" expression=
                    "ChangeOps.editManyWordsInKey(type.type,requestParameters.ID,requestParameters.word)"/>
            <render fragments="voc"/>
        </transition>

        <transition on="addManyWordsAndKey" >
            <evaluate result="out" expression=
                    "ChangeOps.addManyWordsAndKey(requestParameters.key,requestParameters.word,type.type)"/>
            <render fragments="voc"/>
        </transition>
    </view-state>





    <view-state id="temp" view="temp" model="ChangeOps">
        <transition on="nextBin" to="temp">
            <set  name = "type.type"  value = "2"/>
        </transition>
        <transition on="nextRus" to="temp">
            <set  name = "type.type"  value = "1"/>
        </transition>
        <transition on="next" to="main"/>
        <transition on="voc" to="voc">
            <evaluate result="out" expression=
                    "ChangeOps.printKeys(type.type)" />
        </transition>
    </view-state>
</flow>